%% 
%% This is file 'beamerinnerthemeMPIDR.sty'
%% 
%% by Eric Naujoks
%%
%% Problems, bugs and comments to 
%% naujoks@demogr.mpg.de
%%


\ProvidesPackage{./mpidr/beamerinnerthemeMPIDR}

\def\indentspace{0.6cm}
\newlength{\BetweenBoxes}
\setlength{\BetweenBoxes}{\paperwidth}
\addtolength{\BetweenBoxes}{-3.8in}

% Zaehler zur Einstellung des Fusszeilenmodus
\newcount\he@dmode \he@dmode0
\DeclareOptionBeamer{headminiframeon}{\def\he@dmode{0}}
\DeclareOptionBeamer{headtitle}{\def\he@dmode{1}}

\DeclareOptionBeamer{SecondLogo}{\def\beamer@Logo{SecondLogo}}
\DeclareOptionBeamer{SpezLast}{\def\beamer@Last{SpezLast}}
\DeclareOptionBeamer{empty}{\def\beamer@empty}
\ProcessOptionsBeamer\relax

\mode<presentation>


% Some images:
\pgfdeclareimage[width=14pt,height=12pt]{beamericonbook}{beamericonbook}
\pgfdeclareimage[width=14pt,height=12pt]{beamericonbookshaded}{beamericonbook.20}
\pgfaliasimage{beamericonbook.!20opaque}{beamericonbookshaded}
\pgfaliasimage{beamericonbook.!15opaque}{beamericonbookshaded}
\pgfaliasimage{beamericonbook.!10opaque}{beamericonbookshaded}
\pgfaliasimage{beamericonbook.!5opaque}{beamericonbookshaded}
\pgfaliasimage{beamericonbook.!2opaque}{beamericonbookshaded}
\pgfdeclareimage[width=11pt,height=14pt]{beamericonarticle}{beamericonarticle}
\pgfdeclareimage[width=11pt,height=14pt]{beamericonarticleshaded}{beamericonarticle.20}
\pgfaliasimage{beamericonarticle.!20opaque}{beamericonarticleshaded}
\pgfaliasimage{beamericonarticle.!15opaque}{beamericonarticleshaded}
\pgfaliasimage{beamericonarticle.!10opaque}{beamericonarticleshaded}
\pgfaliasimage{beamericonarticle.!5opaque}{beamericonarticleshaded}
\pgfaliasimage{beamericonarticle.!2opaque}{beamericonarticleshaded}


% abgerundete Bl√∂cke ohne Schatten
\setbeamertemplate{blocks}[rounded][shadow=true]


% Navigationssymbole ausblenden
\setbeamertemplate{navigation symbols}{}


% parskip = 0 in the TOC
\let\oldt@bleofcontents\tableofcontents
\let\oldp@rskip\parskip
\renewcommand\tableofcontents[1][]{\vskip 1em\parskip\z@ \oldt@bleofcontents[#1] \parskip\oldp@rskip}


\defbeamertemplate*{button}{mpidr}
{%
  \setbox\beamer@tempbox=\hbox{{\insertbuttontext}}%
  \ht\beamer@tempbox=6pt%
  \dp\beamer@tempbox=0pt%
  \setbox\beamer@tempbox=\vbox{\box\beamer@tempbox\vskip2pt}%
  \beamer@tempdim=\wd\beamer@tempbox%
  \beamer@dima=\beamer@tempdim\advance\beamer@dima by2.2pt
  \beamer@dimb=\beamer@tempdim\advance\beamer@dimb by4pt
  \begin{pgfpicture}{-4pt}{0pt}{\the\beamer@tempdim}{8pt}
    \color{bg}
    \pgfsetlinewidth{0.8pt}
    \pgfpathqmoveto{0pt}{0pt}
    \pgfpathqcurveto{-2.2pt}{0pt}{-4pt}{1.8pt}{-4pt}{4pt}
    \pgfpathqcurveto{-4pt}{6.2pt}{-2.2pt}{8pt}{0pt}{8pt}
    \pgfpathlineto{\pgfpoint{\the\beamer@tempdim}{8pt}}
    \pgfpathcurveto%
    {\pgfpoint{\the\beamer@dima}{8pt}}%
    {\pgfpoint{\the\beamer@dimb}{6.2pt}}%
    {\pgfpoint{\the\beamer@dimb}{4pt}}
    \pgfpathcurveto%
    {\pgfpoint{\the\beamer@dimb}{1.8pt}}%
    {\pgfpoint{\the\beamer@dima}{0pt}}%
    {\pgfpoint{\the\beamer@tempdim}{0pt}}
    \pgfpathclose
    \pgfusepathqfill
    \colorlet{bg}{parent.bg}
    \usebeamercolor[fg]{button border}
    \pgfpathqmoveto{0pt}{0pt}
    \pgfpathqcurveto{-2.2pt}{0pt}{-4pt}{1.8pt}{-4pt}{4pt}
    \pgfpathqcurveto{-4pt}{6.2pt}{-2.2pt}{8pt}{0pt}{8pt}
    \pgfpathlineto{\pgfpoint{\the\beamer@tempdim}{8pt}}
    \pgfpathcurveto%
    {\pgfpoint{\the\beamer@dima}{8pt}}%
    {\pgfpoint{\the\beamer@dimb}{6.2pt}}%
    {\pgfpoint{\the\beamer@dimb}{4pt}}
    \pgfpathcurveto%
    {\pgfpoint{\the\beamer@dimb}{1.8pt}}%
    {\pgfpoint{\the\beamer@dima}{0pt}}%
    {\pgfpoint{\the\beamer@tempdim}{0pt}}
    \pgfpathclose
    \pgfusepathqstroke
  \end{pgfpicture}%
  \hskip-\beamer@tempdim%
  \box\beamer@tempbox%
  \kern4pt%
}


%%%	\institute-command
\def\institute{\@dblarg\beamer@institute}
\long\def\beamer@institute[#1]#2{%
  \def\beamer@temp{#2}%
  \ifx\beamer@temp\@empty
    \def\insertinstitute{}
  \else
    \def\insertinstitute{\def\inst{\beamer@instinst}\def\and{\beamer@andinst}{\setlength{\hangindent}{2em}\scriptsize #2\baselineskip10pt}}%
  \fi
 \def\beamer@shortinstitute{#1}}
\institute{}
\def\beamer@andinst{ \\ }
\def\beamer@instinst#1{{\textsuperscript{#1}}\ignorespaces}

\renewcommand{\date}[2][]{\beamer@origdate{#2}}


%%%	The \author command
\def\author{\@dblarg\beamer@author}
\long\def\beamer@author[#1]#2{%
  \def\insertauthor{\def\inst{\beamer@insttitle}\def\and{\beamer@andtitle}#2}%
  \def\insertauthorLastSpez{\def\inst{\beamer@nothing}\def\and{\beamer@andtitle}#2}%
  \def\beamer@shortauthor{#1}%
  \ifbeamer@autopdfinfo%
    \def\beamer@andstripped{}%
    \beamer@stripands#2 \and\relax
    {\let\inst=\@gobble\let\thanks=\@gobble\def\and{, }\hypersetup{pdfauthor={\beamer@andstripped}}}
  \fi%
}

\def\beamer@stripands#1 \and#2\relax{%
  \def\beamer@temp{#2}%
  \ifx\beamer@temp\@empty
    \expandafter\def\expandafter\beamer@andstripped\expandafter{\beamer@andstripped#1}
  \else
    \expandafter\def\expandafter\beamer@andstripped\expandafter{\beamer@andstripped#1, }
    \beamer@stripands#2\relax%
  \fi
}

\author{}
\def\beamer@nothing#1{}


% Aux commands for \author
\def\beamer@insttitle#1{{\textsuperscript{#1}}}
\def\beamer@andtitle{\quad}
\def\beamer@instother#1{}
\def\beamer@andother{\unskip, }

\renewcommand\insertshortauthor[1][]{%
  {%
    \def\inst{\beamer@instother}\def\and{\beamer@andother}\let\thanks=\@gobble%
    \beamer@setupshort{#1}%
    \beamer@insertshort{\beamer@shortauthor}%
  }}


%%%	The \date command
\def\date{\@dblarg\beamer@date}
\long\def\beamer@date[#1]#2{%
  \def\insertdate{#2}%
  \def\beamer@shortdate{#1}%
  }
\date{\today}

\renewcommand\insertshortdate[1][]{%
  {%
    \let\thanks=\@gobble%
    \beamer@setupshort{#1}%
    \beamer@insertshort{\beamer@shortdate}%
  }}


%%%	The \title command
\renewcommand{\title}{\@dblarg\beamer@title}
\long\def\beamer@title[#1]#2{%
  \def\inserttitle{#2}%
  \def\beamer@shorttitle{#1}%
  \def\insertfattitle{{\large\bfseries #2}}
  }
\title{}


%%%	\Email-command
\def\Email#1{
    \def\insertemail{#1}%
  }
\Email{}


% Titelseite
\defbeamertemplate*{title page}{mpidr}[1][]
{
\vskip -1.5ex
    \begin{beamercolorbox}[wd=\paperwidth,ht=2.8in,dp=1ex,left,leftskip=0cm,rightskip=0cm]{palette quaternary}
		\ifx\beamer@Logo\beamer@empty%
			\vspace*{0.21in}
			\hfill\includegraphics[width=4.7in]{mpidr_logo_colour_en}\hspace*{0.5in}
		\else
			\vspace{0.34in}
			\hspace*{.4in}
			\hbox to\textwidth{\hskip-\Gm@lmargin\hskip 1.9cm
			\includegraphics[height=1.25in]{mpidr_logo_colour_en_solo} \hfill
			\hbox to \BetweenBoxes {\hfil\vbox to 1.25in{\hbox{ Max Planck Institute for Demographic Research}
			\vss  \hbox to \BetweenBoxes{\hskip0pt plus 1fil\insertinstitution\ }}}\hfill \insertsecondlogointitle\hskip-\Gm@rmargin\hspace*{6in}}
			\vskip0.5cm
		\fi
	\end{beamercolorbox}
	
	\vskip1.09in
	\begin{columns}[b]{}
		\begin{column}[b]{0.65\paperwidth}
			\begin{flushright}
				\usebeamerfont{title}\inserttitle\vskip0.4cm
				\usebeamerfont{author}\insertauthor\vskip0.4cm
				{
					\insertinstitute
				}
			\end{flushright}
		\end{column}
		\begin{column}[b]{2.1in}
			%\flushright{\usebeamercolor{palette quaternary}\vrule width 1pt height 120pt}
		\end{column}
	\end{columns}
}


%\interframe-command
\def\interframe#1{
\begin{frame}[plain,t]
    \vskip -1.5ex
    {\parskip0pt\offinterlineskip%
    \hbox{%
      \hskip-\Gm@lmargin%
      \hbox{%
        \vbox{%
          \@tempdima=\textwidth%
          \textwidth=\paperwidth%
          \hsize=\textwidth%
          \def\\{,}%
          \hbox{%
          \begin{beamercolorbox}[wd=.228\paperwidth,ht=1.10ex,dp=1ex,right]{palette quaternary}%
          \usebeamerfont{section in head/foot}   \hspace*{2ex}
          \end{beamercolorbox}%
          \begin{beamercolorbox}[wd=.004\paperwidth,ht=1.10ex,dp=1ex,right]{bg=white}%
          \end{beamercolorbox}%
          \begin{beamercolorbox}[wd=.778\paperwidth,ht=1.10ex,dp=1ex,left]{palette primary}%
          \usebeamerfont{subsection in head/foot}\hspace*{2ex}
          \end{beamercolorbox}
          }
        }}%
      \hskip-\Gm@rmargin%
    }}\hfil%
    
  \vskip0pt%
    \vskip20pt%
    \begin{center}
    \vskip0.5cm
    \begin{columns}
        \begin{column}{0.2\paperwidth}
					\flushright{\usebeamercolor{palette quaternary}\textcolor{colorheading}{\vrule width .004\paperwidth height 120pt}}
        \end{column}
        \begin{column}{0.7\paperwidth}
            #1
        \end{column}
    \end{columns}
    \end{center}
    \vskip0pt plus 1filll
    
    \usebeamertemplate***{footline}
    \vskip-0.15ex
    
\end{frame}    
}


% \lastframe-command
\def\lastframe{
\begin{frame}[t,plain]
\vskip -1.5ex
    \begin{beamercolorbox}[wd=\paperwidth,ht=2.8in,dp=1ex,left,leftskip=0cm,rightskip=0cm]{palette quaternary}
        \ifx\beamer@Logo\beamer@empty%
					\vspace*{0.21in}
					\hfill\includegraphics[width=4.7in]{mpidr_logo_colour_en}\hspace*{0.5in}
        \else
						\vspace{0.34in}
						\hspace*{0.4in}
            \hbox to\textwidth{\hskip-\Gm@lmargin\hskip 1.9cm
						\includegraphics[height=1.25in]{mpidr_logo_colour_en_solo} \hfill
            \hbox to \BetweenBoxes {\hfil\vbox to 1.25in{\hbox{ Max Planck Institute for Demographic Research}
            \vss  \hbox to \BetweenBoxes{\hskip0pt plus 1fil\insertinstitution\ }}}\hfill \insertsecondlogointitle\hskip-\Gm@rmargin\hspace*{3in}}
            \vskip0.5cm
        \fi
    \end{beamercolorbox}
    
    \vskip1.09in
    \begin{columns}[b]{}
				\begin{column}[b]{0.65\paperwidth}
					\begin{flushright}
						{\footnotesize For more information please see} \vskip0.4cm
            {\href{www.demogr.mpg.de}{www.demogr.mpg.de}}\vskip0.8cm
            {
            Contact: 
            \ifx\beamer@Last\beamer@empty%
                \insertauthor \\
                \insertemail
            \else
                \insertauthorLastSpez \\
                \insertemail
            \fi
            }
					\end{flushright}
        \end{column}
        \begin{column}[b]{2.1in}
        %\flushright{\usebeamercolor{palette quaternary}\vrule width 1pt height 120pt}
        \end{column}
    \end{columns}
\end{frame}         
}



%%%	listings etc
%%%	Itemize items
	\defbeamertemplate*{itemize item}{mpidr}{\Large\raise1.25pt\hbox{\donotcoloroutermaths$\blacktriangleright$}}
	\defbeamertemplate*{itemize subitem}{mpidr}{\raise1.25pt\hbox{$\blacktriangleright$}}
	\defbeamertemplate*{itemize subsubitem}{mpidr}{\raise1.25pt\hbox{$\blacktriangleright$}}
%%%	Enumerate items
	%\defbeamertemplateparent{enumerate items}{enumerate item,enumerate subitem,enumerate subsubitem,enumerate mini}{}
	\defbeamertemplate*{enumerate item}{MPIDR}{\insertenumlabel.}
	\defbeamertemplate*{enumerate subitem}{MPIDR}{\insertenumlabel.\insertsubenumlabel}
	\defbeamertemplate*{enumerate subsubitem}{MPIDR}{\insertenumlabel.\insertsubenumlabel.\insertsubsubenumlabel}
	\defbeamertemplate*{enumerate mini template}{MPIDR}{\insertenumlabel}
%%%	Description item width
	\defbeamertemplate*{description item}{MPIDR}{\insertdescriptionitem}


\mode
<all>